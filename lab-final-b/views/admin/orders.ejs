<%- include('partials/header') %>

<div class="admin-container">
  <div class="admin-content">
    <h1>Manage Orders</h1>
    
    <% if (orders && orders.length > 0) { %>
      <div class="admin-table-container">
        <table class="admin-table">
          <thead>
            <tr>
              <th>Order ID</th>
              <th>Customer</th>
              <th>Email</th>
              <th>Date</th>
              <th>Items</th>
              <th>Total</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <% orders.forEach(function(order) { %>
              <tr>
                <td><%= order._id %></td>
                <td><%= order.customer.name %></td>
                <td><%= order.customer.email %></td>
                <td><%= order.createdAt.toLocaleString() %></td>
                <td>
                  <% order.items.forEach(function(item, index) { %>
                    <%= item.name %> Ã— <%= item.quantity %><% if (index < order.items.length - 1) { %>, <% } %>
                  <% }); %>
                </td>
                <td>$<%= order.total.toFixed(2) %></td>
                <td>
                  <span class="status-badge status-<%= order.status.toLowerCase() %>">
                    <%= order.status %>
                  </span>
                </td>
                <td>
                  <form method="POST" action="/admin/orders/<%= order._id %>/status" style="display: inline-block;">
                    <select name="status" onchange="this.form.submit()" style="padding: 5px; border: 1px solid #ddd; border-radius: 4px;">
                      <option value="Placed" <%= order.status === 'Placed' ? 'selected' : '' %> 
                        <%= order.status === 'Processing' || order.status === 'Delivered' ? 'disabled' : '' %>>
                        Placed
                      </option>
                      <option value="Processing" <%= order.status === 'Processing' ? 'selected' : '' %>
                        <%= order.status === 'Delivered' ? 'disabled' : '' %>>
                        Processing
                      </option>
                      <option value="Delivered" <%= order.status === 'Delivered' ? 'selected' : '' %>>
                        Delivered
                      </option>
                    </select>
                  </form>
                </td>
              </tr>
            <% }); %>
          </tbody>
        </table>
      </div>
    <% } else { %>
      <div class="admin-empty-state">
        <p>No orders found.</p>
      </div>
    <% } %>

    <div class="admin-actions">
      <a href="/admin" class="btn-secondary">Back to Dashboard</a>
    </div>
  </div>
</div>

<style>
.status-badge {
  padding: 4px 12px;
  border-radius: 4px;
  font-weight: bold;
  font-size: 12px;
  text-transform: uppercase;
}

.status-placed {
  background: #fff3cd;
  color: #856404;
}

.status-processing {
  background: #cfe2ff;
  color: #084298;
}

.status-delivered {
  background: #d1e7dd;
  color: #0f5132;
}

.admin-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 20px;
}

.admin-table th,
.admin-table td {
  padding: 12px;
  text-align: left;
  border-bottom: 1px solid #ddd;
}

.admin-table th {
  background: #f8f9fa;
  font-weight: bold;
}

.admin-table tr:hover {
  background: #f8f9fa;
}

.admin-table-container {
  overflow-x: auto;
  margin: 20px 0;
}
</style>

<%- include('partials/footer') %>

